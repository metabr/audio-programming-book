//iscale.c// generate E.T. tables for N-notes to the octave  (N<=24)#include <stdio.h>#include <stdlib.h>#include <math.h>//usage iscale [-m] [-i] N startval [outfile.txt]// -m	: sets forms of startval as MIDI note (default: freq,Hz))int main (int argc, char* argv []){int notes,i,x;int ismidi=0;int write_interval = 0;int err = 0;double startval, basefreq, ratio;FILE* fp; //file function(?)double intervals[25]; //note: this is answer for ex3 in previous chapter//1.	//check first arg for flag option: argc has to be at least 2//flag has to be placed before mandatory arguments//eg. iscale 20 0 -m won't work because while loop will break when it sees integer //this will also make argv[1] to be N for later procedure (step 3)while (argc >1)	{	if (argv[1][0]=='-')		{		if(argv[1][1]=='m')		ismidi =1;		else if(argv[1][1]=='i')			 write_interval=1;			 else {			 	  printf("error:unrecognized flag option %s\n",argv[1]);			 	  return 1;			 	  }		//step up to next arg		argc--; //when argc reaches 0, gets out of the loop		argv++; //examine next arguments		}	else 	break;	}			//2.//check if user put minimum amount of argumentsif (argc < 3)	{	printf("insufficient arguments\n");	printf("usage iscale [-m] [-i] N startval [outfile.txt]\n");	return 1;	}//3.//read and check all arguments//3-a// we are expecting argv[1] to be N, argv[2] to be startvalnotes = atoi(argv[1]);if (notes<1 || notes>24)	{	printf("error: N out of range. must be between 1 and 24.\n");	}startval = atof(argv[2]); //char to float(?)//3-b//if midiscaling has been turned onif (ismidi)	{	if (startval<0.0)		{printf("error: MIDI startval must be >=0\n");		 return 1;		}	if (startval>127)		{printf("error: MIDI startval must be <=127\n");		return 1;		}	}else //it's a frequency. => must be positive number//chek low limits	{ 	if (startval <=0.0)		{		printf("error: frequency startval must be positive\n");		return 1;		}	}//4.//check for optional file namefp = NULL; //initializeif(argc==4)		{ 	//read file	fp = fopen(argv[3],"w"); //fopen (const char*name, const char* mode)	if (fp==NULL)		{		printf ("WARNING: unable to creae file %s\n",argv[3]);		perror("");//look for what perror is		}	}// all parameters ready - fill array and write to file if created//5.//find basefreq, if startval is MIDI (-m)if(ismidi)	{	double c0, c5; //local variables	//find base MIDI note	ratio = pow(2.0,1.0/12.0); //can put 12.0 instead of notes since MIDI is E.T	c5 = 220.0 *pow(ratio,3);	c0 = c5 * pow (0.5,5);	basefreq = c0 * pow(ratio,startval);	}else	basefreq = startval; // when startval is not MIDI/*	*/	//6.//calculate ratio from notes, and fill the arrayratio = pow(2.0,1.0/notes);for(i=0;i <= notes;i++) //make sure not to put ; at the end!!!!!	{	intervals[i] = basefreq;	basefreq *= ratio;  //this is NOT pointer. it's basefreq*ratio	}//7. read arrray, write to screen, and optionally to filefor (i=0 ;i<=notes; i++)	{	//write to screen	if (write_interval)		printf ("%d:\t%f\t%f\n",i,pow(ratio,i),intervals[i]);	else		printf ("%d:\t%f\n",i,intervals[i]);	//write to file	if(fp)	{		if(write_interval)			err =  fprintf(fp,"%d:\t%f\t%f\n", i, pow(ratio,(double)i), intervals[i]);		else			err = fprintf(fp,"%d:\t%f\n", i, intervals[i]);		if(err < 0)		break;				}	}if (err<0)	perror("There was an error writing the file.\n");if (fp)	fclose(fp);	return 0;}													